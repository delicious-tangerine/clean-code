깨끗한 코드를 짜려면 지저분한 코드를 짠 뒤에 정리해야 한다. 단계적으로 개선해야 한다.

여러 케이스를 추가하는 순간 코드가 더러워지기 시작한다. 추가할 케이스가 남았지만, 코드가 훨씬 나빠질거라는 사실이 자명했다. 유지 보수하기 좋은 상태로 만들기 위해 당장 케이스를 추가하는 것보다 리팩터링을 바로 시작한다.

케이스를 추가하려면, 주요 지점 몇 군데에다 코드를 추가해야 한다는 사실을 발견한다. 케이스는 다르지만 모두가 유사한 메서드를 제공할 때, 클래스 하나로 분리하는게 적합하다고 판단할 수 있다.

개선 전과 똑같이 프로그램을 돌리기가 아주 어렵다. 따라서 테스트 주도 개발이라는 기법을 사용한다. TDD는 언제 어느 때라도 시스템이 돌아가야 한다는 원칙을 따른다. 다시 말해, TDD는 시스템을 망가뜨리는 변경을 허용하지 않는다. 변경을 가한 후에도 시스템이 변경 전과 똑같이 돌아가야 한다는 말이다.

변경 전후에 시스템이 똑같이 돌아간다는 사실을 확인하려면 언제든 실행이 가능한 자동화된 테스트 슈트가 필요하다.

---

그저 돌아가는 코드만으로는 부족하다. 돌아가는 코드가 심하게 망가지는 사례는 흔하다. 추후 깨끗한 코드로 개선할 수 있지만 비용이 엄청나게 많이 든다.

처음부터 코드를 깨끗하게 유지하는 편이 상대적으로 쉽다. 5분 전에 엉망으로 만든 코드는 지금 당장 정리하기 아주 쉽다.

코드는 언제나 최대한 깔끔하고 단순하게 정리하자.